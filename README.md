![Preview](Readme_assets/logo.png) 
# AutoParts - інтернет-магазин автозапчастин # 

![status](https://img.shields.io/badge/status-beta-brightgreen)
![version](https://img.shields.io/badge/version-1.0.0-informational)
![node](https://img.shields.io/badge/node-%3E%3D18-339933)
![postgres](https://img.shields.io/badge/postgres-%3E%3D13-4169E1)

## Зміст
- [Опис проєкту](#опис-проєкту)
- [Структура проєкту](#структура-проєкту)
- [Зовнішній вигляд головної сторінки сайту](#Зовнішній-вигляд-головної-сторінки-сайту)
- [Налаштування середовища](#налаштування-середовища)
- [Встановлення та запуск](#встановлення-та-запуск)

## Опис проєкту

### Загальна характеристика програмного продукту

AutoParts — це самописний **PHP** проект, побудований за архітектурою **Model > View > Controller**. Проєкт реалізує бізнес-логіку магазину на рівні REST-ендпоінтів і SQL-запитів, залишаючи клієнтським застосункам (frontend, мобільні додатки, адмін-панель) лише відображення даних.

Система орієнтована на реальні сценарії роботи магазину: складна структура каталогу, підбір деталей за параметрами автомобіля, гнучкі методи доставки й оплати, робота з кошиком, замовленнями, знижками та сервісною підтримкою.

### Призначення та мета розробки

Мета розробки — створити **масштабований, розширюваний і технологічно сучасний** додаток для інтернет-магазину автозапчастин, який може бути використаний як:

- навчальний приклад продакшн‑орієнтованої архітектури на Node.js + PostgreSQL;
- основа для реального комерційного проєкту з подальшим доопрацюванням;
- тестовий майданчик для експериментів із бізнес‑логікою, оптимізацією SQL‑запитів, кешуванням тощо.

### Основні функціональні можливості

1. **Каталог товарів**
    - Ієрархія категорій (root/child).
    - Пошук і фільтрація за назвою, брендом, категорією, ціною, наявністю.
    - Підтримка “акційних” пропозицій (top deals, popular).

2. **Підбір за автомобілем**
    - Марка → модель → покоління → модифікація.
    - Прив’язка товарів до конкретних модифікацій авто.
    - Можливість розширення під інші довідники (наприклад, тип двигуна, паливо, рік випуску).

3. **Кошик та замовлення**
    - Створення та оновлення кошика.
    - Додавання/видалення товарів, зміна кількості.
    - Розрахунок підсумкової суми замовлення.
    - Створення замовлення з прив’язкою до користувача, адреси, способів доставки й оплати.

4. **Улюблені (wishlist)**
    - Додавання товарів до списку бажань.
    - Перегляд і видалення позицій зі списку.

5. **Адреси та довідники**
    - Збереження адрес доставки користувача.
    - Довідники методів доставки та оплати, з можливістю розширення.

6. **Система знижок і купонів**
    - Купони з мінімальною сумою замовлення, датами дії, типом знижки (фіксована/відсоткова).
    - Перевірка купона на стороні API.

7. **Тікет‑саппорт**
    - Базова система заявок підтримки.
    - Створення тікетів користувачем, зміна статусу, коментарі (залежно від реалізації).

### Архітектура та структура проєкту

Бекенд реалізовано на базі **Node.js (ESM) + Express** з підключенням до бази даних **PostgreSQL** через модуль `pg`. Логіка роботи організована за схемою:

`view → controllers → models → node.js → db`

## Структура проєкту

- `api/` — бекенд-API на **Node.js + Express** з доступом до PostgreSQL.
    - `db/` — підключення до БД, пул з’єднань і хелпери `dbQuery`.
    - `middlewares/` — middleware для авторизації, CORS, логування, обробки помилок.
    - `models/` — робота з таблицями БД (users, products, orders, carts, addresses, discounts тощо).
    - `routes/` — REST-маршрути (`/api/auth`, `/api/products`, `/api/orders`, `/api/users` і т.д.).
    - `.env` — змінні середовища (порт, параметри БД, секрети).
    - `server.js` — точка входу API, ініціалізація Express та маршрутів.

- `App/` — PHP-шар (MVC), який рендерить HTML і звертається до Node-API.
    - `Controllers/` — контролери сторінок (головна, каталог, кошик, профіль, авторизація, замовлення).
    - `Core/` — ядро: базовий `Controller`, `Router`, `Request/Response`, сесія, CSRF, API-клієнт.
    - `Lang/` — файли локалізації інтерфейсу (uk/en та інші мови).
    - `Models/` — PHP-моделі/адаптери над API та доменними сутностями.
    - `Repositories/` — репозиторії даних (обгортки над API/БД для контролерів).
    - `Serveces/` — сервісний шар (логіка купонів, кошика, підбору запчастин, нотифікацій тощо).
    - `helpers.php` — загальні хелпери (URL, ціни, флеш-повідомлення, локалізація).

- `config/` — конфігурація PHP-додатку.
    - `cacert.pem` — кореневі сертифікати для cURL (Google OAuth, зовнішні HTTPS-API).
    - `google_oauth.php` — налаштування Google OAuth 2.0 (client_id, secret, redirect_uri, scopes).
    - `routes.php` — карта маршрутів PHP-додатку (URL → контролер/метод).

- `public/` — публічна директорія (document root).
    - `views/` — PHP-шаблони сторінок (головна, каталог, товар, кошик, checkout, профіль, логін тощо).
    - `.htaccess` — правила `mod_rewrite` (ЧПУ-URL, роутинг на `index.php`, базове налаштування доступу).
    - `index.php` — front controller: підключає автозавантаження, конфіг, роутер і віддає відповідь клієнту.

### Архітектура проєкту дозволяє:
- легко додавати нові маршрути та сутності;
- підтримувати розділення відповідальностей;
- масштабувати застосунок додаючи в нього нові можливості бізнес-логіки, та функціональностей.

### Безпека та надійність

- Зберігання паролів у вигляді хешів (bcrypt).
- Сесійні токени (UUID) зберігаються в таблиці `user_sessions` з часом життя.
- Можливість примусового завершення сесій користувача (через адмін‑панель).
- Валідація даних на рівні контролерів/моделей.

### Перспективи розвитку

- Інтеграція з платіжними сервісами та службами доставки.
- Впровадження кешування (Redis) для важких запитів каталогу.
- Розширення моделі знижок (персональні пропозиції, промокампанії).
- Підготовка до **мікросервісної архітектури** (виокремлення модулів каталогу, замовлень, користувачів тощо).

### Технології

- **Runtime:** Node.js (ESM), Express
- **Database:** PostgreSQL (`pg` connection pool)
- **Security:** bcrypt (хешування паролів), сесійні токени (UUID)
- **Infra:** dotenv, CORS
- **Архітектура:** `MVC` (SQL‑запити зосереджено у модулях API )
- **Залежності:** bcrypt, cors, dotenv, express, pg, uuid

## Зовнішній вигляд головної сторінки сайту
![Preview](Readme_assets/main_page.gif)

## Налаштування середовища

**api/.env (приклад):**
```env
PORT=3000
PGHOST=localhost
PGUSER=your_user
PGPASSWORD=your_password
PGDATABASE=autoparts-db
PGPORT=5432
```

## Встановлення та запуск

> Вимоги: Node.js **18+**, PostgreSQL **13+**
> XAMPP **8.2.12+**, Apache **2.4+**, PHP **8.0+**.

```bash
# Клонуйте або завантажте репозиторій
git clone https://github.com/LC-system32/AutoParts

# 1) Перейдіть у каталог проекту
cd AutoParts

# 2) Створіть базу даних PostgreSQL,
createdb -U postgres autoparts-db

# 3) Імпортуйте дамп
psql -U postgres -d autoparts-db -f "autoparts-db-full.sql"

# 4) Перейдіть у папку REST-API
cd api

# 2) Встановіть залежності
npm install   # або npm i

# 3) Запустіть REST-API
npm start
# http://localhost:3000 
```
